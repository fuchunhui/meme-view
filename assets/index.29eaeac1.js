var Ze=Object.defineProperty,Qe=Object.defineProperties;var et=Object.getOwnPropertyDescriptors;var Be=Object.getOwnPropertySymbols;var tt=Object.prototype.hasOwnProperty,at=Object.prototype.propertyIsEnumerable;var Ie=(e,a,s)=>a in e?Ze(e,a,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[a]=s,Se=(e,a)=>{for(var s in a||(a={}))tt.call(a,s)&&Ie(e,s,a[s]);if(Be)for(var s of Be(a))at.call(a,s)&&Ie(e,s,a[s]);return e},ze=(e,a)=>Qe(e,et(a));import{r as nt,c as J,o as C,d as P,t as te,a as T,F as Fe,b as Ae,u as r,e as $,f as Z,n as ae,g as ot,h as st,i as w,w as lt,j as re,k as be,l as A,m as Le,p as M,q as ne,s as ke,v as ue,x as ce,y as Re,z as De,A as rt,B as ut,C as ct,D as it}from"./vendor.7337bdb3.js";const dt=function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))t(o);new MutationObserver(o=>{for(const u of o)if(u.type==="childList")for(const i of u.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&t(i)}).observe(document,{childList:!0,subtree:!0});function s(o){const u={};return o.integrity&&(u.integrity=o.integrity),o.referrerpolicy&&(u.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?u.credentials="include":o.crossorigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function t(o){if(o.ep)return;o.ep=!0;const u=s(o);fetch(o.href,u)}};dt();var Pe=(e,a)=>{const s=e.__vccOpts||e;for(const[t,o]of a)s[t]=o;return s};const vt={};function pt(e,a){const s=nt("router-view");return C(),J(s)}var gt=Pe(vt,[["render",pt]]);const mt={class:"side"},ft={class:"side-content-title"},ht=["onClick"],_t=P({props:{catalogList:null,current:null},emits:["change"],setup(e,{emit:a}){const t=te(e).catalogList,o=(u,i)=>{a("change",{type:u,child:i})};return(u,i)=>(C(),T("div",mt,[(C(!0),T(Fe,null,Ae(r(t),p=>(C(),T("div",{key:p.id,class:"side-content"},[$("p",ft,Z(p.text),1),(C(!0),T(Fe,null,Ae(p.children,x=>(C(),T("div",{key:x.mid,class:ae({"side-content-cell":!0,"side-content-cell-active":e.current===x.mid}),onClick:k=>o(p.type,x)},Z(x.title),11,ht))),128))]))),128))]))}});const H=P({props:{label:{type:String,default:"\u63D0\u4EA4"},disabled:{type:Boolean,default:!1}},setup(e){return(a,s)=>(C(),T("button",{class:ae(["meme-button",{disabled:e.disabled}])},[ot(a.$slots,"default",{},()=>[st(Z(e.label),1)])],2))}});const yt=P({name:"Input",props:{modelValue:{type:[String,Number],default:""},title:{type:String,default:""},disabled:{type:Boolean,default:!1}},emits:["update:modelValue","blur"],setup(e,{emit:a}){const s=w(null),t=u=>{a("update:modelValue",u.target.value)};return{input:s,blur:u=>{t(u),a("blur")}}}}),xt=["title","value"];function $t(e,a,s,t,o,u){return C(),T("input",{ref:"input",class:ae(["meme-input",{disabled:e.disabled}]),title:e.title,value:e.modelValue,onBlur:a[0]||(a[0]=(...i)=>e.blur&&e.blur(...i)),onKeyup:a[1]||(a[1]=lt(i=>{var p;return(p=e.input)==null?void 0:p.blur()},["enter"]))},null,42,xt)}var ie=Pe(yt,[["render",$t]]);const wt=500,Ct=300;P({name:"Loading",props:{show:{type:Boolean,default:!0},min:{type:Number,default:wt},interval:{type:Number,default:Ct}},created(){this.showChange(this.show)},setup(e){const{show:a,interval:s,min:t}=te(e),o=w(a.value);let u,i=0;const p=()=>{const y=new Date().getTime()-i;y>t.value?o.value=!1:setTimeout(()=>{o.value=!1},Math.max(t.value-y,0))},x=k=>{k?s.value===0?(o.value=!0,i=new Date().getTime()):u=window.setTimeout(()=>{o.value=!0,i=new Date().getTime()},s.value):(clearTimeout(u),p())};return re(a,()=>{x(a.value)}),{localShow:o,showChange:x}}});const Ft={class:"meme-radio"},bt=["name","value","checked"],kt={class:"meme-radio-label"},oe=P({props:{label:null,name:null,value:null,checked:{type:Boolean}},emits:["toggle"],setup(e,{emit:a}){const s=t=>{a("toggle",t)};return(t,o)=>(C(),T("label",Ft,[$("input",{class:"meme-radio-input",type:"radio",name:e.name,value:e.value,checked:e.checked,onChange:o[0]||(o[0]=u=>s(e.value))},null,40,bt),$("span",kt,Z(e.label),1)]))}});const Dt={class:"meme-file-upload"},Et={class:"file-button"},Mt=$("i",{class:"file-glyphicon"},null,-1),Tt=$("span",null,"UPLOAD FILE",-1),Bt=$("i",{class:"file-tips"},"Drop files here to upload",-1),It=[Bt],St=P({emits:["change"],setup(e,{emit:a}){const s=be("commands"),t=v=>{const d=v.target.files;if(!d)return!1;y(d)},o=v=>{v.stopPropagation(),v.preventDefault()},u=v=>{v.stopPropagation(),v.preventDefault()},i=v=>{v.stopPropagation(),v.preventDefault();const d=v.dataTransfer.files;y(d)},p=v=>{v.stopPropagation(),v.preventDefault();const d=v.clipboardData.files;y(d)},x=1*1024*1024,k=/^image\//,y=v=>{if(v.length!==1)return F("\u4E0D\u652F\u6301\u591A\u4E2A\u6587\u4EF6\u540C\u65F6\u64CD\u4F5C\uFF0C\u8BF7\u4EC5\u9009\u62E9\u5355\u4E2A\u6587\u4EF6"),!1;const d=v[0],{name:f,size:_,type:b}=d;if(!k.test(b))return F(`\u5F53\u524D\u6587\u4EF6\u7C7B\u578B\u4E3A${b}\uFF0C\u7C7B\u578B\u4E0D\u7B26\uFF0C\u8BF7\u9009\u62E9\u56FE\u7247\u7C7B\u578B\uFF01`),!1;const I=f.replace(/\.\w*$/g,"");if(s.value.includes(I))return F(`\u5F53\u524D\u6587\u4EF6\u540D\u79F0\u3010${f}\u3011\u4E0E\u7CFB\u7EDF\u9ED8\u8BA4\u5173\u952E\u6307\u4EE4\u3010${I}\u3011\u51B2\u7A81\uFF0C\u8BF7\u91CD\u547D\u540D\u4E0A\u4F20\u6587\u4EF6\uFF01`),!1;if(_>x)return F("\u6587\u4EF6\u8D85\u8FC7\u6700\u5927\u9650\u52361M\uFF0C\u8BF7\u91CD\u65B0\u9009\u62E9"),!1;const D=new FileReader;D.onload=G=>{const K=G.target.result;L(f,K)},D.onerror=()=>{F(D.error.message)},D.readAsDataURL(d)},F=v=>{alert(v)},L=(v,d)=>{a("change",{name:v,base64:d})};return(v,d)=>(C(),T("div",Dt,[$("div",Et,[Mt,Tt,$("input",{class:"file-input",type:"file",name:"file",accept:"image/*",title:"",onChange:t},null,32)]),$("div",{class:"file-area",draggable:!0,contenteditable:!0,onDragenter:o,onDragover:u,onDrop:i,onPaste:p},It,32)]))}});const zt={version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 32 32"},At=$("title",null,"dice",-1),Lt=["fill"],Rt=P({props:{color:{type:String,default:"#FF0000"}},emits:["click"],setup(e,{emit:a}){const s=e,t=A(()=>["transparent","#FFFFFF"].includes(s.color)?"gray":s.color),o=()=>{a("click")};return(u,i)=>(C(),J(r(H),{class:"dice-button",u:"icon",onClick:o},{default:Le(()=>[(C(),T("svg",zt,[At,$("path",{fill:r(t),d:"M27 6h-16c-2.75 0-5 2.25-5 5v16c0 2.75 2.25 5 5 5h16c2.75 0 5-2.25 5-5v-16c0-2.75-2.25-5-5-5zM13 28c-1.657 0-3-1.343-3-3s1.343-3 3-3 3 1.343 3 3-1.343 3-3 3zM13 16c-1.657 0-3-1.343-3-3s1.343-3 3-3 3 1.343 3 3-1.343 3-3 3zM19 22c-1.657 0-3-1.343-3-3s1.343-3 3-3 3 1.343 3 3-1.343 3-3 3zM25 28c-1.657 0-3-1.343-3-3s1.343-3 3-3 3 1.343 3 3-1.343 3-3 3zM25 16c-1.657 0-3-1.343-3-3s1.343-3 3-3 3 1.343 3 3-1.343 3-3 3zM25.899 4c-0.467-2.275-2.491-4-4.899-4h-16c-2.75 0-5 2.25-5 5v16c0 2.408 1.725 4.432 4 4.899v-19.899c0-1.1 0.9-2 2-2h19.899z"},null,8,Lt)]))]),_:1}))}});const Pt={version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 32 32"},Nt=$("title",null,"picker",-1),Vt=["fill"],Ut=P({props:{color:{type:String,default:"#FF0000"}},emits:["click"],setup(e,{emit:a}){const s=e,t=A(()=>["transparent","#FFFFFF"].includes(s.color)?"gray":s.color),o=()=>{a("click")};return(u,i)=>(C(),J(r(H),{class:"picker-button",u:"icon",onClick:o},{default:Le(()=>[(C(),T("svg",Pt,[Nt,$("path",{fill:r(t),d:"M30.828 1.172c-1.562-1.562-4.095-1.562-5.657 0l-5.379 5.379-3.793-3.793-4.243 4.243 3.326 3.326-14.754 14.754c-0.252 0.252-0.358 0.592-0.322 0.921h-0.008v5c0 0.552 0.448 1 1 1h5c0 0 0.083 0 0.125 0 0.288 0 0.576-0.11 0.795-0.329l14.754-14.754 3.326 3.326 4.243-4.243-3.793-3.793 5.379-5.379c1.562-1.562 1.562-4.095 0-5.657zM5.409 30h-3.409v-3.409l14.674-14.674 3.409 3.409-14.674 14.674z"},null,8,Vt)]))]),_:1}))}});const Wt={class:"property"},Ne=P({props:{max:null,size:null,color:null,align:null,direction:null},emits:["change","pick"],setup(e,{emit:a}){const s=e,t=be("text"),o=be("updateText"),{max:u,size:i,color:p,align:x,direction:k}=te(s),y=(v,d)=>{const f={max:u.value,size:i.value,color:p.value,align:x.value,direction:k.value};f[d]=["color","align","direction"].includes(d)?v:parseInt(v),a("change",f)},F=()=>{const v="#"+Math.floor(Math.random()*16777215).toString(16);y(v,"color")},L=()=>{a("pick")};return(v,d)=>(C(),T("div",Wt,[M(r(ie),{class:"property-max",value:r(u),"onUpdate:modelValue":d[0]||(d[0]=f=>y(f,"max"))},null,8,["value"]),M(r(ie),{class:"property-size",value:r(i),"onUpdate:modelValue":d[1]||(d[1]=f=>y(f,"size"))},null,8,["value"]),M(r(ie),{class:"property-color",value:r(p),"onUpdate:modelValue":d[2]||(d[2]=f=>y(f,"color"))},null,8,["value"]),M(Rt,{color:r(p),onClick:F},null,8,["color"]),M(Ut,{color:r(p),onClick:L},null,8,["color"]),M(r(oe),{label:"start",name:"align",value:"start",checked:r(x)==="start",onToggle:d[3]||(d[3]=f=>y(f,"align"))},null,8,["checked"]),M(r(oe),{label:"center",name:"align",value:"center",checked:r(x)==="center",onToggle:d[4]||(d[4]=f=>y(f,"align"))},null,8,["checked"]),M(r(oe),{class:"property-end",label:"end",name:"align",value:"end",checked:r(x)==="end",onToggle:d[5]||(d[5]=f=>y(f,"align"))},null,8,["checked"]),M(r(ie),{class:"property-text",value:r(t),"onUpdate:modelValue":r(o)},null,8,["value","onUpdate:modelValue"]),M(r(oe),{label:"up",name:"direction",value:"up",checked:r(k)==="up",onToggle:d[6]||(d[6]=f=>y(f,"direction"))},null,8,["checked"]),M(r(oe),{label:"down",name:"direction",value:"down",checked:r(k)==="down",onToggle:d[7]||(d[7]=f=>y(f,"direction"))},null,8,["checked"])]))}}),Ee=1.2,z=11,N=14,Ve=N*z,Ue=N*z,Q=N*z,We=N,Xt=(()=>{const e=[];for(let a=1;a<z;a++)e.push([a,0,a,z]),e.push([0,a,z,a]);return e.map(a=>a.map(s=>s*N))})(),Yt=(e,a,s)=>{let t=0,o=e.length-1;for(;t<=o;){const u=Math.floor((t+o)/2),i=s.measureText(e.substring(0,u)).width,p=s.measureText(e.substring(0,u+1)).width;if(i<=a&&p>a)return u;i<a?t=u+1:o=u-1}return-1},jt=(e,a,s)=>{const t=[];let o=0;for(;(o=Yt(e,a,s))!==-1;)t.push(e.substring(0,o)),e=e.substring(o);return e&&t.push(e),t},Me=(e,a,s,t)=>{const{x:o,y:u,font:i,color:p,align:x,max:k,direction:y}=t;e.font=i||"32px sans-serif",e.fillStyle=p||"#000000",e.textAlign=x||"center";const F=k||a,L=i.match(/(\d{1,3})px/)||["","32"],v=Number(L[1]),d=jt(s,F,e);d.forEach((f,_)=>{const b=y==="down"?_:_-(d.length-1);e.fillText(f,o,u+b*v*Ee,F)})},Ot=e=>{e.imageSmoothingEnabled=!1,e.lineCap="round",e.beginPath(),e.strokeStyle="#000000",e.arc(z*N/2,z*N/2,z*N/2-1,0,Math.PI*2),e.stroke(),e.clip(),e.strokeStyle="#D6D6D6",Xt.forEach(a=>{const{0:s,1:t,2:o,3:u}=a;e.moveTo(s,t),e.lineTo(o,u)}),e.stroke(),e.beginPath(),e.strokeStyle="#FF0000",e.rect((z-1)*N/2,(z-1)*N/2,1*N,1*N),e.stroke()},Xe=(e,a,s,t)=>{a.style.left=`${s+We}px`,a.style.top=`${t+We}px`;const o=a.getContext("2d"),u=Math.min(Math.max(0,s-5),e.width-z),i=Math.min(Math.max(0,t-5),e.height-z);o.clearRect(0,0,Ve,Ue),o.drawImage(e,u,i,z,z,0,0,Ve,Ue),Ot(o)},Ye=(e,a,s)=>{const o=`image/${["jpeg","jpg"].includes(a)?"jpeg":"png"}`,u=e.toDataURL(o),i=document.createElement("a");i.setAttribute("download",s),i.setAttribute("href",u),i.setAttribute("target","_blank"),i.click()};const Ht={class:"container"},Gt={class:"container-header"},Kt={class:"container-title"},qt={key:0,class:"container-wall"},Jt={class:"container-wraper"},Zt=["width","height"],Qt={class:"container-footer"},ea=P({props:{story:null},emits:["change","create","replace"],setup(e,{emit:a}){const t=te(e).story,o=w(null),u=w(null),i=w(null),p=w(!0),x=w(!0);let k=null;const y=w(!1),F=w(!1),L=w(null),v=w("\u91D1\u9986\u957F"),d=n=>{v.value=n,Y()};ne("text",v),ne("updateText",d);const f=w(0),_=w(0),b=(n,l)=>{t.value.x=n,t.value.y=l},I=n=>{const{max:l,size:g,color:h,align:E,direction:S}=n;t.value.max=l,t.value.font=`${g}px sans-serif`,t.value.color=h,t.value.align=E,t.value.direction=S},D=A(()=>{const n=t.value.font.match(/(\d{1,3})px/)||["","32"];return Number(n[1])}),G=A(()=>{var h;return((h=t.value.image.split(";base64,")[0].match(/[a-z]+$/g))==null?void 0:h[0])||"png"}),K=A(()=>`${t.value.title}.${G.value} ${f.value} * ${_.value} (${t.value.x}, ${t.value.y})`),se=A(()=>{const n=t.value.max||f.value;return{start:0,center:Math.floor(n/2),end:n}[t.value.align]}),R=new Image,q=()=>{R.onload=async()=>{const n=o.value;n.width=R.naturalWidth,n.height=R.naturalHeight,f.value=n.width,_.value=n.height,de(),Y(),ee()},R.onerror=n=>{console.error(n)},R.src=t.value.image},de=()=>{const n=u.value;n.style.width=`${f.value}px`,n.style.height=`${_.value}px`},Y=()=>{const n=o.value,l=n.getContext("2d");l.drawImage(R,0,0),Me(l,n.width,v.value,t.value)},ee=()=>{const{x:n,y:l,max:g}=t.value,h=i.value;h.style.width=`${g}px`,h.style.height=`${D.value*Ee}px`,h.style.top=`${l-D.value+2}px`,h.style.left=`${n-se.value}px`};re(t,(n,l)=>{n.mid!==l.mid?q():(Y(),ee())},{deep:!0});let j=0,O=0;const B=20;let V=!1;const ve=n=>{V=!0;const{clientX:l,clientY:g}=n;j=l,O=g},pe=n=>{if(!V)return;const{clientX:l,clientY:g}=n,h=i.value,{width:E,height:S}=h.getBoundingClientRect();let U=h.offsetLeft+l-j,W=h.offsetTop+g-O;U<-B||W<-B||U>f.value-E+B||W>_.value-S+B?V=!1:(j=l,O=g),U=Math.max(Math.min(U,f.value-E+B),-B),W=Math.max(Math.min(W,_.value-S+B),-B),U+=se.value,W+=D.value-2,b(U,W)},ge=()=>{!V||(V=!1)},me=()=>{p.value?p.value=!1:(p.value=!0,x.value=!0,k?(le(k),k=null):q())},fe=()=>{const n=o.value,l=`imeme_${t.value.title}_${v.value}`;Ye(n,G.value,l)},he=()=>{p.value?a("change",t.value):x.value||(a("create",t.value),p.value=!0,x.value=!0)},_e=({name:n,base64:l})=>{x.value=!1;const{mid:g,title:h,feature:E,image:S,x:U,y:W,max:Oe,font:He,color:Ge,align:Ke,direction:qe,senior:Je}=t.value;k={mid:g,title:h,feature:E,image:S,x:U,y:W,max:Oe,font:He,color:Ge,align:Ke,direction:qe,senior:Je};const Te=n.slice(0,n.lastIndexOf("."));le({mid:`meme_${new Date().getTime()}`,title:Te,feature:Te,image:l,x:60,y:60,max:100,font:"32px sans-serif",color:"#FF0000",align:"start",direction:"down",senior:0})},le=n=>{a("replace",n)},ye=()=>{y.value=!0},xe=(n,l)=>{const g=o.value,h=L.value;Xe(g,h,n,l)},$e=async n=>{if(!y.value)return!1;const{offsetX:l,offsetY:g}=n;l<0||g<0||(F.value=!0,xe(l,g))},we=()=>{if(!y.value)return!1;F.value=!1},Ce=n=>{const l=U=>U.toString(16).padStart(2,"0"),{0:g,1:h,2:E,3:S}=n.data;return`#${l(g)}${l(h)}${l(E)}${l(S)}`.toUpperCase()},c=(n,l)=>{const E=o.value.getContext("2d").getImageData(n,l,1,1);return Ce(E)},m=n=>{if(!y.value)return!1;const{offsetX:l,offsetY:g}=n;if(l<0||g<0)return;const h=c(l,g);t.value.color=h,F.value=!1,y.value=!1};return ke(()=>{q()}),(n,l)=>(C(),T("div",Ht,[$("div",Gt,[$("div",Kt,Z(r(K)),1),M(r(H),{label:p.value?"\u6DFB\u52A0":"\u53D6\u6D88\u6DFB\u52A0",u:"primary",onClick:me},null,8,["label"]),M(r(H),{label:"\u4E0B\u8F7D",u:"primary",onClick:fe})]),!p.value&&x.value?(C(),T("div",qt,[M(r(St),{onChange:_e})])):(C(),T(Fe,{key:1},[$("div",Jt,[$("canvas",{ref:(g,h)=>{h.canvasRef=g,o.value=g},class:ae({"container-canvas":!0,"container-pointer":y.value}),onMousemove:$e,onMouseleave:we,onClick:m},null,34),ue($("div",{class:"container-area",ref:(g,h)=>{h.areaRef=g,u.value=g},onMousemove:pe,onMouseup:ge},[$("div",{class:"container-drag",ref:(g,h)=>{h.dragRef=g,i.value=g},onMousedown:ve},null,544)],544),[[ce,!y.value]]),ue($("canvas",{ref:(g,h)=>{h.layerRef=g,L.value=g},class:"container-layer",style:Re({borderRadius:`${r(Q)}px`}),width:r(Q),height:r(Q)},null,12,Zt),[[ce,y.value&&F.value]])]),M(Ne,{max:r(t).max,color:r(t).color,size:r(D),align:r(t).align,direction:r(t).direction,onChange:I,onPick:ye},null,8,["max","color","size","align","direction"])],64)),$("footer",Qt,[M(r(H),{label:p.value?"\u66F4\u65B0":"\u786E\u8BA4",u:"primary",onClick:he},null,8,["label"])])]))}});const ta={class:"container"},aa={class:"container-header"},na={class:"container-title"},oa={class:"container-wraper"},sa=["width","height"],la={class:"container-footer"},ra=P({props:{feature:null},emits:["change"],setup(e,{emit:a}){const t=te(e).feature,o=w(null),u=w(null),i=w(null),p=w(!1),x=w(!1),k=w(null),y="\u91D1\u9986\u957F",F=w("\u91D1\u9986\u957F"),L=c=>{F.value=c,Y()};ne("text",F),ne("updateText",L);const v=w(0),d=w(0),f=A(()=>t.value.type==="TEXT"),_=A(()=>{var c;if(f.value){const m=((c=t.value.et)==null?void 0:c.font.match(/(\d{1,3})px/))||["","32"];return Number(m[1])}return 0}),b=A(()=>{var l;return((l=t.value.story.image.split(";base64,")[0].match(/[a-z]+$/g))==null?void 0:l[0])||"png"}),I=A(()=>{const c=f.value?D.value:G.value;return`${t.value.story.title}.${b.value} ${v.value} * ${d.value} (${c.x}, ${c.y})`}),D=A(()=>t.value.et),G=A(()=>t.value.ei),K=A(()=>{if(f.value){const c=D.value.max||v.value;return{start:0,center:Math.floor(c/2),end:c}[D.value.align]}return 0}),se=c=>{const{max:m,size:n,color:l,align:g,direction:h}=c;t.value.et.max=m,t.value.et.font=`${n}px sans-serif`,t.value.et.color=l,t.value.et.align=g,t.value.et.direction=h},R=new Image,q=()=>{R.onload=async()=>{const c=o.value;c.width=R.naturalWidth,c.height=R.naturalHeight,v.value=c.width,d.value=c.height,de(),Y(),f.value&&ee()},R.onerror=c=>{console.error(c)},R.src=t.value.story.image},de=()=>{const c=u.value;c.style.width=`${v.value}px`,c.style.height=`${d.value}px`},Y=()=>{const c=o.value,m=c.getContext("2d");m.drawImage(R,0,0),m.save(),Me(m,c.width,y,t.value.story),f.value&&(m.restore(),Me(m,c.width,F.value,D.value))},ee=()=>{if(f.value){const{x:c,y:m,max:n}=D.value,l=i.value;l.style.width=`${n}px`,l.style.height=`${_.value*Ee}px`,l.style.top=`${m-_.value+2}px`,l.style.left=`${c-K.value}px`}};re(t,(c,m)=>{c.mid!==m.mid?q():(Y(),ee())},{deep:!0});let j=0,O=0;const B=20;let V=!1;const ve=c=>{V=!0;const{clientX:m,clientY:n}=c;j=m,O=n},pe=c=>{if(!V)return;const{clientX:m,clientY:n}=c,l=i.value,{width:g,height:h}=l.getBoundingClientRect();let E=l.offsetLeft+m-j,S=l.offsetTop+n-O;E<-B||S<-B||E>v.value-g+B||S>d.value-h+B?V=!1:(j=m,O=n),E=Math.max(Math.min(E,v.value-g+B),-B),S=Math.max(Math.min(S,d.value-h+B),-B),E+=K.value,S+=_.value-2,ge(E,S)},ge=(c,m)=>{D.value.x=c,D.value.y=m},me=()=>{!V||(V=!1)},fe=()=>{const c=o.value,m=`imeme_${t.value.story.title}_${F.value}`;Ye(c,b.value,m)},he=()=>{t.value,a("change",{mid:t.value.mid,type:t.value.type,options:t.value.et})},_e=()=>{p.value=!0},le=(c,m)=>{const n=o.value,l=k.value;Xe(n,l,c,m)},ye=async c=>{if(!p.value)return!1;const{offsetX:m,offsetY:n}=c;m<0||n<0||(x.value=!0,le(m,n))},xe=()=>{if(!p.value)return!1;x.value=!1},$e=c=>{const m=E=>E.toString(16).padStart(2,"0"),{0:n,1:l,2:g,3:h}=c.data;return`#${m(n)}${m(l)}${m(g)}${m(h)}`.toUpperCase()},we=(c,m)=>{const g=o.value.getContext("2d").getImageData(c,m,1,1);return $e(g)},Ce=c=>{if(!p.value)return!1;const{offsetX:m,offsetY:n}=c;if(m<0||n<0)return;const l=we(m,n);t.value.et.color=l,x.value=!1,p.value=!1};return ke(()=>{q()}),(c,m)=>(C(),T("div",ta,[$("div",aa,[$("div",na,Z(r(I)),1),M(r(H),{label:"\u4E0B\u8F7D",u:"primary",onClick:fe})]),$("div",oa,[$("canvas",{ref:(n,l)=>{l.canvasRef=n,o.value=n},class:ae({"container-canvas":!0,"container-pointer":p.value}),onMousemove:ye,onMouseleave:xe,onClick:Ce},null,34),ue($("div",{class:"container-area",ref:(n,l)=>{l.areaRef=n,u.value=n},onMousemove:pe,onMouseup:me},[$("div",{class:"container-drag",ref:(n,l)=>{l.dragRef=n,i.value=n},onMousedown:ve},null,544)],544),[[ce,!p.value]]),ue($("canvas",{ref:(n,l)=>{l.layerRef=n,k.value=n},class:"container-layer",style:Re({borderRadius:`${r(Q)}px`}),width:r(Q),height:r(Q)},null,12,sa),[[ce,p.value&&x.value]])]),r(f)?(C(),J(Ne,{key:0,max:r(D).max,color:r(D).color,size:r(_),align:r(D).align,direction:r(D).direction,onChange:se,onPick:_e},null,8,["max","color","size","align","direction"])):De("",!0),$("footer",la,[M(r(H),{label:"\u66F4\u65B0",u:"primary",onClick:he})])]))}}),je={getCatalog:{url:"/image/catalog",method:"get"},openImage:{url:"/image/open",method:"get"},saveImage:{url:"/image/save",method:"post"},createImage:{url:"/image/create",method:"post"},getCommands:{url:"/image/commands",method:"get"},getFeatureImage:{url:"/image/feature/open",method:"get"}},ua=()=>"https://imeme.vercel.app";var ca=e=>async(a={},s={})=>{const{url:t,method:o}=e,u=ua();return rt.request({withCredentials:!1,url:u+t,method:o,[o==="get"?"params":"data"]:a}).then(i=>{const p=i.data;return(s==null?void 0:s.stream)?i:p.errNo===0?p.data:Promise.reject(p)}).catch(i=>Promise.reject(i))};const X={};for(const e in je)X[e]=ca(je[e]);const ia={class:"image-wrap"},da=P({setup(e){const a=w([]),s=w(""),t=w("");let o=w({mid:"",title:"",feature:"",image:"",x:0,y:0,max:100,font:"32px sans-serif",color:"#FFFFFF",align:"start",direction:"down",senior:0}),u=w({mid:"",feature:"",type:"",story:o});const i=async()=>{const _=await X.getCatalog({});a.value=_},p=({type:_,child:b})=>{s.value!==b.mid&&(s.value=b.mid,t.value=_)};re([s,t],()=>{x(s.value,t.value)});const x=(_,b)=>{d.value?X.openImage({mid:_,type:b}).then(I=>{o.value=I}):X.getFeatureImage({mid:_}).then(I=>{u.value=I})},k=_=>{const b=ze(Se({},_),{image:""});X.saveImage(b)},y=_=>{o.value=_},F=async _=>{const b=await X.createImage(_).catch(I=>{alert(I.message)});await i(),s.value=b.mid},L=w([]);ne("commands",L);const v=async()=>{const _=await X.getCommands({});L.value=_},d=A(()=>["STORY","SERIES","SPECIAL"].includes(t.value)),f=({mid:_,type:b,options:I})=>{console.log("\u66F4\u65B0feature \u6570\u636E",_,b,I),b==="TEXT"&&X.saveImage(I)};return ke(()=>{i(),v()}),(_,b)=>(C(),T("div",ia,[M(_t,{current:s.value,"catalog-list":a.value,onChange:p},null,8,["current","catalog-list"]),r(d)&&r(o).image&&r(o).mid?(C(),J(ea,{key:0,story:r(o),onChange:k,onReplace:y,onCreate:F},null,8,["story"])):De("",!0),t.value==="FEATURE"&&r(u).mid?(C(),J(ra,{key:1,feature:r(u),onChange:f},null,8,["feature"])):De("",!0)]))}});const va={class:"material-center"},pa=P({setup(e){return(a,s)=>(C(),T("div",va," \u4EC0\u4E48\u90FD\u6CA1\u6709\u7684\u8352\u539F "))}}),ga=[{path:"/",component:da},{path:"/center",component:pa}],ma=ut({history:ct(),routes:ga});it(gt).use(ma).mount("#app");
