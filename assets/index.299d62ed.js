var tt=Object.defineProperty,at=Object.defineProperties;var nt=Object.getOwnPropertyDescriptors;var Ne=Object.getOwnPropertySymbols;var ot=Object.prototype.hasOwnProperty,st=Object.prototype.propertyIsEnumerable;var Ve=(e,a,s)=>a in e?tt(e,a,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[a]=s,Be=(e,a)=>{for(var s in a||(a={}))ot.call(a,s)&&Ve(e,s,a[s]);if(Ne)for(var s of Ne(a))st.call(a,s)&&Ve(e,s,a[s]);return e},Xe=(e,a)=>at(e,nt(a));import{r as lt,c as ee,o as b,d as U,t as le,a as I,F as Se,b as Ye,u as r,e as C,f as te,n as re,g as rt,h as ut,i as F,w as ct,j as pe,k as Re,l as P,m as Ue,p as B,q as ue,s as ze,v as ge,x as fe,y as We,z as it,A as me,B as dt,C as vt,D as pt,E as gt}from"./vendor.8b6f53e9.js";const ft=function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))t(n);new MutationObserver(n=>{for(const u of n)if(u.type==="childList")for(const d of u.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&t(d)}).observe(document,{childList:!0,subtree:!0});function s(n){const u={};return n.integrity&&(u.integrity=n.integrity),n.referrerpolicy&&(u.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?u.credentials="include":n.crossorigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function t(n){if(n.ep)return;n.ep=!0;const u=s(n);fetch(n.href,u)}};ft();var je=(e,a)=>{const s=e.__vccOpts||e;for(const[t,n]of a)s[t]=n;return s};const mt={};function ht(e,a){const s=lt("router-view");return b(),ee(s)}var _t=je(mt,[["render",ht]]);const yt={class:"side"},xt={class:"side-content-title"},wt=["onClick"],$t=U({props:{catalogList:null,current:null},emits:["change"],setup(e,{emit:a}){const t=le(e).catalogList,n=(u,d)=>{a("change",{type:u,child:d})};return(u,d)=>(b(),I("div",yt,[(b(!0),I(Se,null,Ye(r(t),g=>(b(),I("div",{key:g.id,class:"side-content"},[C("p",xt,te(g.text),1),(b(!0),I(Se,null,Ye(g.children,$=>(b(),I("div",{key:$.mid,class:re({"side-content-cell":!0,"side-content-cell-active":e.current===$.mid}),onClick:M=>n(g.type,$)},te($.title),11,wt))),128))]))),128))]))}});const J=U({props:{label:{type:String,default:"\u63D0\u4EA4"},disabled:{type:Boolean,default:!1}},setup(e){return(a,s)=>(b(),I("button",{class:re(["meme-button",{disabled:e.disabled}])},[rt(a.$slots,"default",{},()=>[ut(te(e.label),1)])],2))}});const Ct=U({name:"Input",props:{modelValue:{type:[String,Number],default:""},title:{type:String,default:""},disabled:{type:Boolean,default:!1}},emits:["update:modelValue","blur"],setup(e,{emit:a}){const s=F(null),t=u=>{a("update:modelValue",u.target.value)};return{input:s,blur:u=>{t(u),a("blur")}}}}),Ft=["title","value"];function bt(e,a,s,t,n,u){return b(),I("input",{ref:"input",class:re(["meme-input",{disabled:e.disabled}]),title:e.title,value:e.modelValue,onBlur:a[0]||(a[0]=(...d)=>e.blur&&e.blur(...d)),onKeyup:a[1]||(a[1]=ct(d=>{var g;return(g=e.input)==null?void 0:g.blur()},["enter"]))},null,42,Ft)}var he=je(Ct,[["render",bt]]);const kt=500,Dt=300;U({name:"Loading",props:{show:{type:Boolean,default:!0},min:{type:Number,default:kt},interval:{type:Number,default:Dt}},created(){this.showChange(this.show)},setup(e){const{show:a,interval:s,min:t}=le(e),n=F(a.value);let u,d=0;const g=()=>{const w=new Date().getTime()-d;w>t.value?n.value=!1:setTimeout(()=>{n.value=!1},Math.max(t.value-w,0))},$=M=>{M?s.value===0?(n.value=!0,d=new Date().getTime()):u=window.setTimeout(()=>{n.value=!0,d=new Date().getTime()},s.value):(clearTimeout(u),g())};return pe(a,()=>{$(a.value)}),{localShow:n,showChange:$}}});const Mt={class:"meme-radio"},Et=["name","value","checked"],Tt={class:"meme-radio-label"},ce=U({props:{label:null,name:null,value:null,checked:{type:Boolean}},emits:["toggle"],setup(e,{emit:a}){const s=t=>{a("toggle",t)};return(t,n)=>(b(),I("label",Mt,[C("input",{class:"meme-radio-input",type:"radio",name:e.name,value:e.value,checked:e.checked,onChange:n[0]||(n[0]=u=>s(e.value))},null,40,Et),C("span",Tt,te(e.label),1)]))}});const It={class:"meme-file-upload"},Bt={class:"file-button"},St=C("i",{class:"file-glyphicon"},null,-1),Rt=C("span",null,"UPLOAD FILE",-1),zt=C("i",{class:"file-tips"},"Drop files here to upload",-1),At=[zt],Lt=U({emits:["change"],setup(e,{emit:a}){const s=Re("commands"),t=p=>{const v=p.target.files;if(!v)return!1;w(v)},n=p=>{p.stopPropagation(),p.preventDefault()},u=p=>{p.stopPropagation(),p.preventDefault()},d=p=>{p.stopPropagation(),p.preventDefault();const v=p.dataTransfer.files;w(v)},g=p=>{p.stopPropagation(),p.preventDefault();const v=p.clipboardData.files;w(v)},$=1*1024*1024,M=/^image\//,w=p=>{if(p.length!==1)return k("\u4E0D\u652F\u6301\u591A\u4E2A\u6587\u4EF6\u540C\u65F6\u64CD\u4F5C\uFF0C\u8BF7\u4EC5\u9009\u62E9\u5355\u4E2A\u6587\u4EF6"),!1;const v=p[0],{name:f,size:y,type:D}=v;if(!M.test(D))return k(`\u5F53\u524D\u6587\u4EF6\u7C7B\u578B\u4E3A${D}\uFF0C\u7C7B\u578B\u4E0D\u7B26\uFF0C\u8BF7\u9009\u62E9\u56FE\u7247\u7C7B\u578B\uFF01`),!1;const A=f.replace(/\.\w*$/g,"");if(s.value.includes(A))return k(`\u5F53\u524D\u6587\u4EF6\u540D\u79F0\u3010${f}\u3011\u4E0E\u7CFB\u7EDF\u9ED8\u8BA4\u5173\u952E\u6307\u4EE4\u3010${A}\u3011\u51B2\u7A81\uFF0C\u8BF7\u91CD\u547D\u540D\u4E0A\u4F20\u6587\u4EF6\uFF01`),!1;if(y>$)return k("\u6587\u4EF6\u8D85\u8FC7\u6700\u5927\u9650\u52361M\uFF0C\u8BF7\u91CD\u65B0\u9009\u62E9"),!1;const E=new FileReader;E.onload=V=>{const Z=V.target.result;N(f,Z)},E.onerror=()=>{k(E.error.message)},E.readAsDataURL(v)},k=p=>{alert(p)},N=(p,v)=>{a("change",{name:p,base64:v})};return(p,v)=>(b(),I("div",It,[C("div",Bt,[St,Rt,C("input",{class:"file-input",type:"file",name:"file",accept:"image/*",title:"",onChange:t},null,32)]),C("div",{class:"file-area",draggable:!0,contenteditable:!0,onDragenter:n,onDragover:u,onDrop:d,onPaste:g},At,32)]))}});const Pt={version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 32 32"},Nt=C("title",null,"dice",-1),Vt=["fill"],Xt=U({props:{color:{type:String,default:"#FF0000"}},emits:["click"],setup(e,{emit:a}){const s=e,t=P(()=>["transparent","#FFFFFF"].includes(s.color)?"gray":s.color),n=()=>{a("click")};return(u,d)=>(b(),ee(r(J),{class:"dice-button",u:"icon",onClick:n},{default:Ue(()=>[(b(),I("svg",Pt,[Nt,C("path",{fill:r(t),d:"M27 6h-16c-2.75 0-5 2.25-5 5v16c0 2.75 2.25 5 5 5h16c2.75 0 5-2.25 5-5v-16c0-2.75-2.25-5-5-5zM13 28c-1.657 0-3-1.343-3-3s1.343-3 3-3 3 1.343 3 3-1.343 3-3 3zM13 16c-1.657 0-3-1.343-3-3s1.343-3 3-3 3 1.343 3 3-1.343 3-3 3zM19 22c-1.657 0-3-1.343-3-3s1.343-3 3-3 3 1.343 3 3-1.343 3-3 3zM25 28c-1.657 0-3-1.343-3-3s1.343-3 3-3 3 1.343 3 3-1.343 3-3 3zM25 16c-1.657 0-3-1.343-3-3s1.343-3 3-3 3 1.343 3 3-1.343 3-3 3zM25.899 4c-0.467-2.275-2.491-4-4.899-4h-16c-2.75 0-5 2.25-5 5v16c0 2.408 1.725 4.432 4 4.899v-19.899c0-1.1 0.9-2 2-2h19.899z"},null,8,Vt)]))]),_:1}))}});const Yt={version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 32 32"},Ut=C("title",null,"picker",-1),Wt=["fill"],jt=U({props:{color:{type:String,default:"#FF0000"}},emits:["click"],setup(e,{emit:a}){const s=e,t=P(()=>["transparent","#FFFFFF"].includes(s.color)?"gray":s.color),n=()=>{a("click")};return(u,d)=>(b(),ee(r(J),{class:"picker-button",u:"icon",onClick:n},{default:Ue(()=>[(b(),I("svg",Yt,[Ut,C("path",{fill:r(t),d:"M30.828 1.172c-1.562-1.562-4.095-1.562-5.657 0l-5.379 5.379-3.793-3.793-4.243 4.243 3.326 3.326-14.754 14.754c-0.252 0.252-0.358 0.592-0.322 0.921h-0.008v5c0 0.552 0.448 1 1 1h5c0 0 0.083 0 0.125 0 0.288 0 0.576-0.11 0.795-0.329l14.754-14.754 3.326 3.326 4.243-4.243-3.793-3.793 5.379-5.379c1.562-1.562 1.562-4.095 0-5.657zM5.409 30h-3.409v-3.409l14.674-14.674 3.409 3.409-14.674 14.674z"},null,8,Wt)]))]),_:1}))}});const Ot={class:"property"},Oe=U({props:{max:null,size:null,color:null,align:null,direction:null},emits:["change","pick"],setup(e,{emit:a}){const s=e,t=Re("text"),n=Re("updateText"),{max:u,size:d,color:g,align:$,direction:M}=le(s),w=(p,v)=>{const f={max:u.value,size:d.value,color:g.value,align:$.value,direction:M.value};f[v]=["color","align","direction"].includes(v)?p:parseInt(p),a("change",f)},k=()=>{const p="#"+Math.floor(Math.random()*16777215).toString(16);w(p,"color")},N=()=>{a("pick")};return(p,v)=>(b(),I("div",Ot,[B(r(he),{class:"property-max",value:r(u),"onUpdate:modelValue":v[0]||(v[0]=f=>w(f,"max"))},null,8,["value"]),B(r(he),{class:"property-size",value:r(d),"onUpdate:modelValue":v[1]||(v[1]=f=>w(f,"size"))},null,8,["value"]),B(r(he),{class:"property-color",value:r(g),"onUpdate:modelValue":v[2]||(v[2]=f=>w(f,"color"))},null,8,["value"]),B(Xt,{color:r(g),onClick:k},null,8,["color"]),B(jt,{color:r(g),onClick:N},null,8,["color"]),B(r(ce),{label:"start",name:"align",value:"start",checked:r($)==="start",onToggle:v[3]||(v[3]=f=>w(f,"align"))},null,8,["checked"]),B(r(ce),{label:"center",name:"align",value:"center",checked:r($)==="center",onToggle:v[4]||(v[4]=f=>w(f,"align"))},null,8,["checked"]),B(r(ce),{class:"property-end",label:"end",name:"align",value:"end",checked:r($)==="end",onToggle:v[5]||(v[5]=f=>w(f,"align"))},null,8,["checked"]),B(r(he),{class:"property-text",value:r(t),"onUpdate:modelValue":r(n)},null,8,["value","onUpdate:modelValue"]),B(r(ce),{label:"up",name:"direction",value:"up",checked:r(M)==="up",onToggle:v[6]||(v[6]=f=>w(f,"direction"))},null,8,["checked"]),B(r(ce),{label:"down",name:"direction",value:"down",checked:r(M)==="down",onToggle:v[7]||(v[7]=f=>w(f,"direction"))},null,8,["checked"])]))}}),Ae=1.2,L=11,j=14,He=j*L,Ge=j*L,ae=j*L,Ke=j,Ht=(()=>{const e=[];for(let a=1;a<L;a++)e.push([a,0,a,L]),e.push([0,a,L,a]);return e.map(a=>a.map(s=>s*j))})(),Gt=(e,a,s)=>{let t=0,n=e.length-1;for(;t<=n;){const u=Math.floor((t+n)/2),d=s.measureText(e.substring(0,u)).width,g=s.measureText(e.substring(0,u+1)).width;if(d<=a&&g>a)return u;d<a?t=u+1:n=u-1}return-1},Kt=(e,a,s)=>{const t=[];let n=0;for(;(n=Gt(e,a,s))!==-1;)t.push(e.substring(0,n)),e=e.substring(n);return e&&t.push(e),t},Le=(e,a,s,t)=>{const{x:n,y:u,font:d,color:g,align:$,max:M,direction:w}=t;e.font=d||"32px sans-serif",e.fillStyle=g||"#000000",e.textAlign=$||"center";const k=M||a,N=d.match(/(\d{1,3})px/)||["","32"],p=Number(N[1]),v=Kt(s,k,e);v.forEach((f,y)=>{const D=w==="down"?y:y-(v.length-1);e.fillText(f,n,u+D*p*Ae,k)})},qt=e=>{e.imageSmoothingEnabled=!1,e.lineCap="round",e.beginPath(),e.strokeStyle="#000000",e.arc(L*j/2,L*j/2,L*j/2-1,0,Math.PI*2),e.stroke(),e.clip(),e.strokeStyle="#D6D6D6",Ht.forEach(a=>{const{0:s,1:t,2:n,3:u}=a;e.moveTo(s,t),e.lineTo(n,u)}),e.stroke(),e.beginPath(),e.strokeStyle="#FF0000",e.rect((L-1)*j/2,(L-1)*j/2,1*j,1*j),e.stroke()},qe=(e,a,s,t)=>{a.style.left=`${s+Ke}px`,a.style.top=`${t+Ke}px`;const n=a.getContext("2d"),u=Math.min(Math.max(0,s-5),e.width-L),d=Math.min(Math.max(0,t-5),e.height-L);n.clearRect(0,0,He,Ge),n.drawImage(e,u,d,L,L,0,0,He,Ge),qt(n)},Je=(e,a,s)=>{const n=`image/${["jpeg","jpg"].includes(a)?"jpeg":"png"}`,u=e.toDataURL(n),d=document.createElement("a");d.setAttribute("download",s),d.setAttribute("href",u),d.setAttribute("target","_blank"),d.click()};const Jt={class:"container"},Zt={class:"container-header"},Qt={class:"container-title"},ea={key:0,class:"container-wall"},ta={class:"container-wraper"},aa=["width","height"],na={class:"container-footer"},oa=U({props:{story:null},emits:["change","create","replace"],setup(e,{emit:a}){const t=le(e).story,n=F(null),u=F(null),d=F(null),g=F(!0),$=F(!0);let M=null;const w=F(!1),k=F(!1),N=F(null),p=F("\u91D1\u9986\u957F"),v=i=>{p.value=i,G()};ue("text",p),ue("updateText",v);const f=F(0),y=F(0),D=(i,m)=>{t.value.x=i,t.value.y=m},A=i=>{const{max:m,size:_,color:x,align:W,direction:o}=i;t.value.max=m,t.value.font=`${_}px sans-serif`,t.value.color=x,t.value.align=W,t.value.direction=o},E=P(()=>{const i=t.value.font.match(/(\d{1,3})px/)||["","32"];return Number(i[1])}),V=P(()=>{var x;return((x=t.value.image.split(";base64,")[0].match(/[a-z]+$/g))==null?void 0:x[0])||"png"}),Z=P(()=>`${t.value.title}.${V.value} ${f.value} * ${y.value} (${t.value.x}, ${t.value.y})`),ie=P(()=>{const i=t.value.max||f.value;return{start:0,center:Math.floor(i/2),end:i}[t.value.align]}),X=new Image,Q=()=>{X.onload=async()=>{const i=n.value;i.width=X.naturalWidth,i.height=X.naturalHeight,f.value=i.width,y.value=i.height,_e(),G(),ne()},X.onerror=i=>{console.error(i)},X.src=t.value.image},_e=()=>{const i=u.value;i.style.width=`${f.value}px`,i.style.height=`${y.value}px`},G=()=>{const i=n.value,m=i.getContext("2d");m.drawImage(X,0,0),Le(m,i.width,p.value,t.value)},ne=()=>{const{x:i,y:m,max:_}=t.value,x=d.value;x.style.width=`${_}px`,x.style.height=`${E.value*Ae}px`,x.style.top=`${m-E.value+2}px`,x.style.left=`${i-ie.value}px`};pe(t,(i,m)=>{i.mid!==m.mid?Q():(G(),ne())},{deep:!0});let K=0,q=0;const S=20;let O=!1;const ye=i=>{O=!0;const{clientX:m,clientY:_}=i;K=m,q=_},xe=i=>{if(!O)return;const{clientX:m,clientY:_}=i,x=d.value,{width:W,height:o}=x.getBoundingClientRect();let l=x.offsetLeft+m-K,c=x.offsetTop+_-q;l<-S||c<-S||l>f.value-W+S||c>y.value-o+S?O=!1:(K=m,q=_),l=Math.max(Math.min(l,f.value-W+S),-S),c=Math.max(Math.min(c,y.value-o+S),-S),l+=ie.value,c+=E.value-2,D(l,c)},we=()=>{!O||(O=!1)},$e=()=>{g.value?g.value=!1:(g.value=!0,$.value=!0,M?(de(M),M=null):Q())},Ce=()=>{const i=n.value,m=`imeme_${t.value.title}_${p.value}`;Je(i,V.value,m)},Fe=()=>{g.value?a("change",t.value):$.value||(a("create",t.value),g.value=!0,$.value=!0)},be=({name:i,base64:m})=>{$.value=!1;const{mid:_,title:x,feature:W,image:o,x:l,y:c,max:h,font:T,color:R,align:z,direction:Y,senior:se}=t.value;M={mid:_,title:x,feature:W,image:o,x:l,y:c,max:h,font:T,color:R,align:z,direction:Y,senior:se};const ve=i.slice(0,i.lastIndexOf("."));de({mid:`meme_${new Date().getTime()}`,title:ve,feature:ve,image:m,x:60,y:60,max:100,font:"32px sans-serif",color:"#FF0000",align:"start",direction:"down",senior:0})},de=i=>{a("replace",i)},ke=()=>{w.value=!0},De=(i,m)=>{const _=n.value,x=N.value;qe(_,x,i,m)},Me=async i=>{if(!w.value)return!1;const{offsetX:m,offsetY:_}=i;m<0||_<0||(k.value=!0,De(m,_))},Ee=()=>{if(!w.value)return!1;k.value=!1},Te=i=>{const m=l=>l.toString(16).padStart(2,"0"),{0:_,1:x,2:W,3:o}=i.data;return`#${m(_)}${m(x)}${m(W)}${m(o)}`.toUpperCase()},Ie=(i,m)=>{const W=n.value.getContext("2d").getImageData(i,m,1,1);return Te(W)},oe=i=>{if(!w.value)return!1;const{offsetX:m,offsetY:_}=i;if(m<0||_<0)return;const x=Ie(m,_);t.value.color=x,k.value=!1,w.value=!1};return ze(()=>{Q()}),(i,m)=>(b(),I("div",Jt,[C("div",Zt,[C("div",Qt,te(r(Z)),1),B(r(J),{label:g.value?"\u6DFB\u52A0":"\u53D6\u6D88\u6DFB\u52A0",u:"primary",onClick:$e},null,8,["label"]),B(r(J),{label:"\u4E0B\u8F7D",u:"primary",onClick:Ce})]),!g.value&&$.value?(b(),I("div",ea,[B(r(Lt),{onChange:be})])):(b(),I(Se,{key:1},[C("div",ta,[C("canvas",{ref:(_,x)=>{x.canvasRef=_,n.value=_},class:re({"container-canvas":!0,"container-pointer":w.value}),onMousemove:Me,onMouseleave:Ee,onClick:oe},null,34),ge(C("div",{class:"container-area",ref:(_,x)=>{x.areaRef=_,u.value=_},onMousemove:xe,onMouseup:we},[C("div",{class:"container-drag",ref:(_,x)=>{x.dragRef=_,d.value=_},onMousedown:ye},null,544)],544),[[fe,!w.value]]),ge(C("canvas",{ref:(_,x)=>{x.layerRef=_,N.value=_},class:"container-layer",style:We({borderRadius:`${r(ae)}px`}),width:r(ae),height:r(ae)},null,12,aa),[[fe,w.value&&k.value]])]),B(Oe,{max:r(t).max,color:r(t).color,size:r(E),align:r(t).align,direction:r(t).direction,onChange:A,onPick:ke},null,8,["max","color","size","align","direction"])],64)),C("footer",na,[B(r(J),{label:g.value?"\u66F4\u65B0":"\u786E\u8BA4",u:"primary",onClick:Fe},null,8,["label"])])]))}});const sa={class:"container"},la={class:"container-header"},ra={class:"container-title"},ua=["onMousedown"],ca=["width","height"],ia={class:"container-footer"},da=U({props:{feature:null},emits:["change"],setup(e,{emit:a}){const t=le(e).feature,n=F(null),u=F(null),d=F(null),g=F(!1),$=F(!1),M=F(null),w="\u91D1\u9986\u957F",k=F("\u91D1\u9986\u957F"),N=o=>{k.value=o,G()};ue("text",k),ue("updateText",N);const p=F(0),v=F(0),f=P(()=>t.value.type==="TEXT"),y=P(()=>{var o;if(f.value){const l=((o=t.value.et)==null?void 0:o.font.match(/(\d{1,3})px/))||["","32"];return Number(l[1])}return 0}),D=P(()=>{var h;return((h=t.value.story.image.split(";base64,")[0].match(/[a-z]+$/g))==null?void 0:h[0])||"png"}),A=P(()=>{const o=f.value?E.value:V.value;return`${t.value.story.title}.${D.value} ${p.value} * ${v.value} (${o.x}, ${o.y})`}),E=P(()=>t.value.et),V=P(()=>t.value.ei),Z=P(()=>{if(f.value){const o=E.value.max||p.value;return{start:0,center:Math.floor(o/2),end:o}[E.value.align]}return 0}),ie=o=>{const{max:l,size:c,color:h,align:T,direction:R}=o;t.value.et.max=l,t.value.et.font=`${c}px sans-serif`,t.value.et.color=h,t.value.et.align=T,t.value.et.direction=R},X=new Image,Q=()=>{X.onload=async()=>{const o=n.value;o.width=X.naturalWidth,o.height=X.naturalHeight,p.value=o.width,v.value=o.height,_e(),G(),ne()},X.onerror=o=>{console.error(o)},X.src=t.value.story.image},_e=()=>{const o=u.value;o.style.width=`${p.value}px`,o.style.height=`${v.value}px`},G=()=>{const o=n.value,l=o.getContext("2d");l.drawImage(X,0,0),l.save(),Le(l,o.width,w,t.value.story),f.value&&(l.restore(),Le(l,o.width,k.value,E.value))},ne=()=>{let o=0,l=0,c=0,h=0;if(f.value){const{x:R,y:z,max:Y}=E.value;o=Y,l=y.value*Ae,c=z-y.value+2,h=R-Z.value}else{const{x:R,y:z,width:Y,height:se}=V.value;o=Y,l=se,c=z,h=R}const T=d.value;T.style.width=`${o}px`,T.style.height=`${l}px`,T.style.top=`${c}px`,T.style.left=`${h}px`};pe(t,(o,l)=>{o.mid!==l.mid?Q():(G(),ne())},{deep:!0});let K=0,q=0;const S=20;let O=!1;const ye=o=>{O=!0;const{clientX:l,clientY:c}=o;K=l,q=c},xe=o=>{if(!O)return;const{clientX:l,clientY:c}=o,h=d.value,{width:T,height:R}=h.getBoundingClientRect();let z=h.offsetLeft+l-K,Y=h.offsetTop+c-q;z<-S||Y<-S||z>p.value-T+S||Y>v.value-R+S?O=!1:(K=l,q=c),z=Math.max(Math.min(z,p.value-T+S),-S),Y=Math.max(Math.min(Y,v.value-R+S),-S),we(z,Y)},we=(o,l)=>{f.value?(E.value.x=o+Z.value,E.value.y=l+y.value-2):(V.value.x=o,V.value.y=l)},$e=()=>{!O||(O=!1)},Ce=()=>{const o=n.value,l=`imeme_${t.value.story.title}_${k.value}`;Je(o,D.value,l)},Fe=()=>{const{mid:o,type:l,et:c,ei:h}=t.value;a("change",{mid:o,type:l,options:f.value?c:h})},be=()=>{g.value=!0},de=(o,l)=>{const c=n.value,h=M.value;qe(c,h,o,l)},ke=async o=>{if(!g.value)return!1;const{offsetX:l,offsetY:c}=o;l<0||c<0||($.value=!0,de(l,c))},De=()=>{if(!g.value)return!1;$.value=!1},Me=o=>{const l=z=>z.toString(16).padStart(2,"0"),{0:c,1:h,2:T,3:R}=o.data;return`#${l(c)}${l(h)}${l(T)}${l(R)}`.toUpperCase()},Ee=(o,l)=>{const T=n.value.getContext("2d").getImageData(o,l,1,1);return Me(T)},Te=o=>{if(!g.value)return!1;const{offsetX:l,offsetY:c}=o;if(l<0||c<0)return;const h=Ee(l,c);t.value.et.color=h,$.value=!1,g.value=!1},Ie=F(null);let oe=0,i=0,m=!1;const _=o=>{m=!0;const{clientX:l,clientY:c}=o;oe=l,i=c},x=o=>{if(!m)return;const{clientX:l,clientY:c}=o,h=u.value,{x:T,y:R,width:z,height:Y}=h.getBoundingClientRect();if(l<T||c<R||l>T+z||c>R+Y){m=!1;return}const se=l-oe,ve=c-i,{width:Qe,height:et}=V.value,Pe=d.value;Pe.style.width=`${Qe+se}px`,Pe.style.height=`${et+ve}px`},W=o=>{if(!m)return;m=!1;const{clientX:l,clientY:c}=o,h=l-oe,T=c-i,{width:R,height:z}=V.value;V.value.width=R+h,V.value.height=z+T};return ze(()=>{Q()}),(o,l)=>(b(),I("div",sa,[C("div",la,[C("div",ra,te(r(A)),1),B(r(J),{label:"\u4E0B\u8F7D",u:"primary",onClick:Ce})]),C("div",{class:"container-wraper",onMousemove:x,onMouseup:W},[C("canvas",{ref:(c,h)=>{h.canvasRef=c,n.value=c},class:re({"container-canvas":!0,"container-pointer":g.value}),onMousemove:ke,onMouseleave:De,onClick:Te},null,34),ge(C("div",{class:"container-area",ref:(c,h)=>{h.areaRef=c,u.value=c},onMousemove:xe,onMouseup:$e},[C("div",{class:"container-drag",ref:(c,h)=>{h.dragRef=c,d.value=c},onMousedown:ye},[r(f)?me("",!0):(b(),I("div",{key:0,ref:(c,h)=>{h.cornerRef=c,Ie.value=c},class:"container-drag-corner",onMousedown:it(_,["stop","prevent"])},null,40,ua))],544)],544),[[fe,!g.value]]),ge(C("canvas",{ref:(c,h)=>{h.layerRef=c,M.value=c},class:"container-layer",style:We({borderRadius:`${r(ae)}px`}),width:r(ae),height:r(ae)},null,12,ca),[[fe,g.value&&$.value]])],32),r(f)?(b(),ee(Oe,{key:0,max:r(E).max,color:r(E).color,size:r(y),align:r(E).align,direction:r(E).direction,onChange:ie,onPick:be},null,8,["max","color","size","align","direction"])):me("",!0),C("footer",ia,[B(r(J),{label:"\u66F4\u65B0",u:"primary",onClick:Fe})])]))}}),Ze={getCatalog:{url:"/image/catalog",method:"get"},openImage:{url:"/image/open",method:"get"},saveImage:{url:"/image/save",method:"post"},createImage:{url:"/image/create",method:"post"},getCommands:{url:"/image/commands",method:"get"},getFeatureImage:{url:"/image/feature/open",method:"get"},saveFeatureImage:{url:"/image/feature/save",method:"post"}},va=()=>"https://imeme.vercel.app";var pa=e=>async(a={},s={})=>{const{url:t,method:n}=e,u=va();return dt.request({withCredentials:!1,url:u+t,method:n,[n==="get"?"params":"data"]:a}).then(d=>{const g=d.data;return(s==null?void 0:s.stream)?d:g.errNo===0?g.data:Promise.reject(g)}).catch(d=>Promise.reject(d))};const H={};for(const e in Ze)H[e]=pa(Ze[e]);const ga={class:"image-wrap"},fa=U({setup(e){const a=F([]),s=F(""),t=F("");let n=F({mid:"",title:"",feature:"",image:"",x:0,y:0,max:100,font:"32px sans-serif",color:"#FFFFFF",align:"start",direction:"down",senior:0}),u=F({mid:"",feature:"",type:"",story:n});const d=async()=>{const y=await H.getCatalog({});a.value=y},g=({type:y,child:D})=>{s.value!==D.mid&&(s.value=D.mid,t.value=y)};pe([s,t],()=>{$(s.value,t.value)});const $=(y,D)=>{v.value?H.openImage({mid:y,type:D}).then(A=>{n.value=A}):H.getFeatureImage({mid:y}).then(A=>{u.value=A})},M=y=>{const D=Xe(Be({},y),{image:""});H.saveImage(D)},w=y=>{n.value=y},k=async y=>{const D=await H.createImage(y).catch(A=>{alert(A.message)});await d(),s.value=D.mid},N=F([]);ue("commands",N);const p=async()=>{const y=await H.getCommands({});N.value=y},v=P(()=>["STORY","SERIES","SPECIAL"].includes(t.value)),f=({mid:y,type:D,options:A})=>{D==="TEXT"?H.saveImage(A):H.saveFeatureImage(Be({mid:y,type:D},A))};return ze(()=>{d(),p()}),(y,D)=>(b(),I("div",ga,[B($t,{current:s.value,"catalog-list":a.value,onChange:g},null,8,["current","catalog-list"]),r(v)&&r(n).image&&r(n).mid?(b(),ee(oa,{key:0,story:r(n),onChange:M,onReplace:w,onCreate:k},null,8,["story"])):me("",!0),t.value==="FEATURE"&&r(u).mid?(b(),ee(da,{key:1,feature:r(u),onChange:f},null,8,["feature"])):me("",!0)]))}});const ma={class:"material-center"},ha=U({setup(e){return(a,s)=>(b(),I("div",ma," \u4EC0\u4E48\u90FD\u6CA1\u6709\u7684\u8352\u539F "))}}),_a=[{path:"/",component:fa},{path:"/center",component:ha}],ya=vt({history:pt(),routes:_a});gt(_t).use(ya).mount("#app");
